<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 8.1.0 (20230707.2238)
 -->
<!-- Pages: 1 -->
<svg width="449pt" height="784pt"
 viewBox="0.00 0.00 448.50 784.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 780)">
<polygon fill="white" stroke="none" points="-4,4 -4,-780 444.5,-780 444.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M331.5,-776C331.5,-776 301.5,-776 301.5,-776 295.5,-776 289.5,-770 289.5,-764 289.5,-764 289.5,-752 289.5,-752 289.5,-746 295.5,-740 301.5,-740 301.5,-740 331.5,-740 331.5,-740 337.5,-740 343.5,-746 343.5,-752 343.5,-752 343.5,-764 343.5,-764 343.5,-770 337.5,-776 331.5,-776"/>
<text text-anchor="middle" x="316.5" y="-754.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Start</text>
</g>
<!-- allpacketsprocessed -->
<g id="node3" class="node">
<title>allpacketsprocessed</title>
<polygon fill="none" stroke="black" points="316.5,-703 250.25,-671 316.5,-639 382.75,-671 316.5,-703"/>
<text text-anchor="middle" x="316.5" y="-673.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">All packets</text>
<text text-anchor="middle" x="316.5" y="-661.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">processed?</text>
</g>
<!-- start&#45;&gt;allpacketsprocessed -->
<g id="edge1" class="edge">
<title>start&#45;&gt;allpacketsprocessed</title>
<path fill="none" stroke="black" d="M316.5,-739.8C316.5,-732.35 316.5,-723.27 316.5,-714.21"/>
<polygon fill="black" stroke="black" points="320,-714.27 316.5,-704.27 313,-714.27 320,-714.27"/>
</g>
<!-- end -->
<g id="node2" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M237.5,-591C237.5,-591 207.5,-591 207.5,-591 201.5,-591 195.5,-585 195.5,-579 195.5,-579 195.5,-567 195.5,-567 195.5,-561 201.5,-555 207.5,-555 207.5,-555 237.5,-555 237.5,-555 243.5,-555 249.5,-561 249.5,-567 249.5,-567 249.5,-579 249.5,-579 249.5,-585 243.5,-591 237.5,-591"/>
<text text-anchor="middle" x="222.5" y="-569.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">End</text>
</g>
<!-- allpacketsprocessed&#45;&gt;end -->
<g id="edge3" class="edge">
<title>allpacketsprocessed&#45;&gt;end</title>
<path fill="none" stroke="black" d="M295.64,-648.69C281.27,-634.02 262.12,-614.46 247.02,-599.04"/>
<polygon fill="black" stroke="black" points="250.03,-597.1 240.54,-592.4 245.03,-601.99 250.03,-597.1"/>
<text text-anchor="middle" x="274.38" y="-611.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- nextpacket -->
<g id="node7" class="node">
<title>nextpacket</title>
<path fill="none" stroke="black" d="M353.38,-591C353.38,-591 279.62,-591 279.62,-591 273.62,-591 267.62,-585 267.62,-579 267.62,-579 267.62,-567 267.62,-567 267.62,-561 273.62,-555 279.62,-555 279.62,-555 353.38,-555 353.38,-555 359.38,-555 365.38,-561 365.38,-567 365.38,-567 365.38,-579 365.38,-579 365.38,-585 359.38,-591 353.38,-591"/>
<text text-anchor="middle" x="316.5" y="-575.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Select next packet</text>
<text text-anchor="middle" x="316.5" y="-563.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">from pool</text>
</g>
<!-- allpacketsprocessed&#45;&gt;nextpacket -->
<g id="edge2" class="edge">
<title>allpacketsprocessed&#45;&gt;nextpacket</title>
<path fill="none" stroke="black" d="M316.5,-638.57C316.5,-626.84 316.5,-613.6 316.5,-602.18"/>
<polygon fill="black" stroke="black" points="320,-602.49 316.5,-592.49 313,-602.49 320,-602.49"/>
<text text-anchor="middle" x="321.75" y="-611.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- shortestdistance -->
<g id="node4" class="node">
<title>shortestdistance</title>
<polygon fill="none" stroke="black" points="237.5,-372 153.25,-340 237.5,-308 321.75,-340 237.5,-372"/>
<text text-anchor="middle" x="237.5" y="-342.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Distance to cell</text>
<text text-anchor="middle" x="237.5" y="-330.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">edge shortest?</text>
</g>
<!-- outeredge -->
<g id="node5" class="node">
<title>outeredge</title>
<polygon fill="none" stroke="black" points="320.5,-260 228.75,-228 320.5,-196 412.25,-228 320.5,-260"/>
<text text-anchor="middle" x="320.5" y="-230.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Escaping through</text>
<text text-anchor="middle" x="320.5" y="-218.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">surface?</text>
</g>
<!-- shortestdistance&#45;&gt;outeredge -->
<g id="edge7" class="edge">
<title>shortestdistance&#45;&gt;outeredge</title>
<path fill="none" stroke="black" d="M255.92,-314.59C267.55,-299.17 282.73,-279.06 295.45,-262.2"/>
<polygon fill="black" stroke="black" points="298.61,-264.82 301.84,-254.72 293.03,-260.6 298.61,-264.82"/>
<text text-anchor="middle" x="288.38" y="-280.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- interact -->
<g id="node12" class="node">
<title>interact</title>
<path fill="none" stroke="black" d="M199.12,-246C199.12,-246 51.88,-246 51.88,-246 45.88,-246 39.88,-240 39.88,-234 39.88,-234 39.88,-222 39.88,-222 39.88,-216 45.88,-210 51.88,-210 51.88,-210 199.12,-210 199.12,-210 205.12,-210 211.12,-216 211.12,-222 211.12,-222 211.12,-234 211.12,-234 211.12,-240 205.12,-246 199.12,-246"/>
<text text-anchor="middle" x="125.5" y="-230.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Move packet to interaction location,</text>
<text text-anchor="middle" x="125.5" y="-218.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">perform interaction</text>
</g>
<!-- shortestdistance&#45;&gt;interact -->
<g id="edge8" class="edge">
<title>shortestdistance&#45;&gt;interact</title>
<path fill="none" stroke="black" d="M214.56,-316.47C196.09,-298.32 170.12,-272.82 150.99,-254.04"/>
<polygon fill="black" stroke="black" points="153.84,-251.95 144.26,-247.44 148.94,-256.94 153.84,-251.95"/>
<text text-anchor="middle" x="189.75" y="-280.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- inneredge -->
<g id="node6" class="node">
<title>inneredge</title>
<polygon fill="none" stroke="black" points="147.5,-148 73,-116 147.5,-84 222,-116 147.5,-148"/>
<text text-anchor="middle" x="147.5" y="-118.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Crossing into</text>
<text text-anchor="middle" x="147.5" y="-106.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">photosphere?</text>
</g>
<!-- outeredge&#45;&gt;inneredge -->
<g id="edge12" class="edge">
<title>outeredge&#45;&gt;inneredge</title>
<path fill="none" stroke="black" d="M288.77,-206.82C259.86,-188.44 217.09,-161.25 186.19,-141.6"/>
<polygon fill="black" stroke="black" points="188.33,-138.18 178.01,-135.76 184.57,-144.08 188.33,-138.18"/>
<text text-anchor="middle" x="243.75" y="-168.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- spectralcontrib -->
<g id="node13" class="node">
<title>spectralcontrib</title>
<path fill="none" stroke="black" d="M397,-134C397,-134 252,-134 252,-134 246,-134 240,-128 240,-122 240,-122 240,-110 240,-110 240,-104 246,-98 252,-98 252,-98 397,-98 397,-98 403,-98 409,-104 409,-110 409,-110 409,-122 409,-122 409,-128 403,-134 397,-134"/>
<text text-anchor="middle" x="324.5" y="-112.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Determine contribution to spectrum</text>
</g>
<!-- outeredge&#45;&gt;spectralcontrib -->
<g id="edge11" class="edge">
<title>outeredge&#45;&gt;spectralcontrib</title>
<path fill="none" stroke="black" d="M321.62,-196.07C322.21,-180.01 322.92,-160.55 323.48,-144.95"/>
<polygon fill="black" stroke="black" points="327,-145.5 323.87,-135.38 320.01,-145.24 327,-145.5"/>
<text text-anchor="middle" x="330.38" y="-168.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- crossintoshell -->
<g id="node10" class="node">
<title>crossintoshell</title>
<path fill="none" stroke="black" d="M79,-36C79,-36 12,-36 12,-36 6,-36 0,-30 0,-24 0,-24 0,-12 0,-12 0,-6 6,0 12,0 12,0 79,0 79,0 85,0 91,-6 91,-12 91,-12 91,-24 91,-24 91,-30 85,-36 79,-36"/>
<text text-anchor="middle" x="45.5" y="-20.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Move packet into</text>
<text text-anchor="middle" x="45.5" y="-8.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">next cell</text>
</g>
<!-- inneredge&#45;&gt;crossintoshell -->
<g id="edge14" class="edge">
<title>inneredge&#45;&gt;crossintoshell</title>
<path fill="none" stroke="black" d="M124.61,-93.46C108.86,-78.63 87.91,-58.92 71.53,-43.5"/>
<polygon fill="black" stroke="black" points="74.57,-41.62 64.89,-37.31 69.78,-46.71 74.57,-41.62"/>
<text text-anchor="middle" x="98.75" y="-56.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- terminate -->
<g id="node11" class="node">
<title>terminate</title>
<path fill="none" stroke="black" d="M370,-36C370,-36 279,-36 279,-36 273,-36 267,-30 267,-24 267,-24 267,-12 267,-12 267,-6 273,0 279,0 279,0 370,0 370,0 376,0 382,-6 382,-12 382,-12 382,-24 382,-24 382,-30 376,-36 370,-36"/>
<text text-anchor="middle" x="324.5" y="-20.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Terminate propagation,</text>
<text text-anchor="middle" x="324.5" y="-8.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">discard packet</text>
</g>
<!-- inneredge&#45;&gt;terminate -->
<g id="edge13" class="edge">
<title>inneredge&#45;&gt;terminate</title>
<path fill="none" stroke="black" d="M179.55,-97.62C208.53,-81.9 251.37,-58.66 282.97,-41.52"/>
<polygon fill="black" stroke="black" points="284.26,-44.26 291.39,-36.42 280.93,-38.11 284.26,-44.26"/>
<text text-anchor="middle" x="264.38" y="-56.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- initpacket -->
<g id="node8" class="node">
<title>initpacket</title>
<path fill="none" stroke="black" d="M284.62,-518C284.62,-518 224.38,-518 224.38,-518 218.38,-518 212.38,-512 212.38,-506 212.38,-506 212.38,-494 212.38,-494 212.38,-488 218.38,-482 224.38,-482 224.38,-482 284.62,-482 284.62,-482 290.62,-482 296.62,-488 296.62,-494 296.62,-494 296.62,-506 296.62,-506 296.62,-512 290.62,-518 284.62,-518"/>
<text text-anchor="middle" x="254.5" y="-496.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Initialize packet</text>
</g>
<!-- nextpacket&#45;&gt;initpacket -->
<g id="edge4" class="edge">
<title>nextpacket&#45;&gt;initpacket</title>
<path fill="none" stroke="black" d="M301.49,-554.81C293.95,-546.18 284.67,-535.56 276.36,-526.03"/>
<polygon fill="black" stroke="black" points="278.58,-524.26 269.37,-519.03 273.31,-528.86 278.58,-524.26"/>
</g>
<!-- calculatedistances -->
<g id="node9" class="node">
<title>calculatedistances</title>
<path fill="none" stroke="black" d="M222.5,-445C222.5,-445 98.5,-445 98.5,-445 92.5,-445 86.5,-439 86.5,-433 86.5,-433 86.5,-421 86.5,-421 86.5,-415 92.5,-409 98.5,-409 98.5,-409 222.5,-409 222.5,-409 228.5,-409 234.5,-415 234.5,-421 234.5,-421 234.5,-433 234.5,-433 234.5,-439 228.5,-445 222.5,-445"/>
<text text-anchor="middle" x="160.5" y="-429.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Calculated distances:</text>
<text text-anchor="middle" x="160.5" y="-417.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">to next cell, to next interaction</text>
</g>
<!-- initpacket&#45;&gt;calculatedistances -->
<g id="edge5" class="edge">
<title>initpacket&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M231.75,-481.81C219.83,-472.81 205.04,-461.64 192.03,-451.82"/>
<polygon fill="black" stroke="black" points="194.46,-448.51 184.37,-445.27 190.24,-454.09 194.46,-448.51"/>
</g>
<!-- calculatedistances&#45;&gt;shortestdistance -->
<g id="edge6" class="edge">
<title>calculatedistances&#45;&gt;shortestdistance</title>
<path fill="none" stroke="black" d="M176.08,-408.8C185.6,-398.29 198.05,-384.55 209.26,-372.18"/>
<polygon fill="black" stroke="black" points="211.28,-375.06 215.4,-365.3 206.09,-370.36 211.28,-375.06"/>
</g>
<!-- crossintoshell&#45;&gt;calculatedistances -->
<g id="edge10" class="edge">
<title>crossintoshell&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M35.3,-36.39C25.28,-55.14 11.5,-86.18 11.5,-115 11.5,-341 11.5,-341 11.5,-341 11.5,-375.7 42.36,-396.42 75.99,-408.7"/>
<polygon fill="black" stroke="black" points="74.41,-412.19 85,-412.09 76.65,-405.56 74.41,-412.19"/>
</g>
<!-- terminate&#45;&gt;allpacketsprocessed -->
<g id="edge16" class="edge">
<title>terminate&#45;&gt;allpacketsprocessed</title>
<path fill="none" stroke="black" d="M371.68,-36.43C403.8,-51.69 440.5,-77.36 440.5,-115 440.5,-574 440.5,-574 440.5,-574 440.5,-613.4 400.88,-638.93 366.42,-653.68"/>
<polygon fill="black" stroke="black" points="365.37,-650.74 357.42,-657.74 368,-657.23 365.37,-650.74"/>
</g>
<!-- interact&#45;&gt;calculatedistances -->
<g id="edge9" class="edge">
<title>interact&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M126.92,-246.32C129.34,-273.36 134.94,-327.18 144.5,-372 146.34,-380.64 148.88,-389.92 151.39,-398.29"/>
<polygon fill="black" stroke="black" points="148.3,-399.16 154.61,-407.67 154.99,-397.08 148.3,-399.16"/>
</g>
<!-- spectralcontrib&#45;&gt;terminate -->
<g id="edge15" class="edge">
<title>spectralcontrib&#45;&gt;terminate</title>
<path fill="none" stroke="black" d="M324.5,-97.84C324.5,-83.73 324.5,-63.45 324.5,-47"/>
<polygon fill="black" stroke="black" points="328,-47.34 324.5,-37.34 321,-47.34 328,-47.34"/>
</g>
</g>
</svg>
